{
  "entities": {
    "patient_profile": {
      "title": "Patient Profile",
      "description": "Stores patient information, device association, and alert thresholds.",
      "type": "object",
      "properties": {
        "patient_id": { "type": "string", "description": "The unique ID of the patient, matches the auth UID." },
        "device_id": { "type": "string", "description": "The ID of the ESP32 device assigned to the patient." },
        "name": { "type": "string" },
        "age": { "type": "number" },
        "gender": { "type": "string", "enum": ["Male", "Female", "Other"] },
        "email": { "type": "string", "format": "email" },
        "phone": { "type": "string" },
        "baseline_hr": { "type": "number" },
        "baseline_spo2": { "type": "number" },
        "baseline_bp_systolic": { "type": "number" },
        "baseline_bp_diastolic": { "type": "number" },
        "has_diabetes": { "type": "boolean" },
        "has_hypertension": { "type": "boolean" },
        "has_heart_condition": { "type": "boolean" },
        "alert_threshold_hr_high": { "type": "number" },
        "alert_threshold_hr_low": { "type": "number" },
        "alert_threshold_spo2_low": { "type": "number" },
        "alert_threshold_bp_systolic_high": { "type": "number" },
        "alert_threshold_glucose_high": { "type": "number" },
        "emergency_contact_name": { "type": "string" },
        "emergency_contact_phone": { "type": "string" },
        "created_at": { "type": "string", "format": "date-time" },
        "updated_at": { "type": "string", "format": "date-time" },
        "is_active": { "type": "boolean" }
      },
      "required": ["patient_id", "device_id", "email", "is_active", "created_at", "updated_at"]
    },
    "health_vitals": {
      "title": "Health Vitals",
      "description": "A single time-series reading of raw and predicted health data.",
      "type": "object",
      "properties": {
        "timestamp": { "type": "string", "format": "date-time" },
        "device_id": { "type": "string" },
        "heart_rate": { "type": "number" },
        "spo2": { "type": "number" },
        "ppg_raw": { "type": "number" },
        "predicted_bp_systolic": { "type": "number" },
        "predicted_bp_diastolic": { "type": "number" },
        "predicted_glucose": { "type": "number" },
        "alert_flag": { "type": "boolean" },
        "created_at": { "type": "string", "format": "date-time" }
      },
      "required": ["timestamp", "device_id", "heart_rate", "spo2", "ppg_raw", "alert_flag", "created_at"]
    },
    "alert_history": {
      "title": "Alert History",
      "description": "A log of all alerts triggered by the system.",
      "type": "object",
      "properties": {
        "alert_timestamp": { "type": "string", "format": "date-time" },
        "alert_id": { "type": "string" },
        "device_id": { "type": "string" },
        "patient_id": { "type": "string" },
        "alert_type": { "type": "string" },
        "severity": { "type": "string", "enum": ["Critical", "High", "Medium", "Low"] },
        "alert_message": { "type": "string" },
        "heart_rate": { "type": "number" },
        "spo2": { "type": "number" },
        "ppg_raw": { "type": "number" },
        "predicted_bp_systolic": { "type": "number" },
        "predicted_bp_diastolic": { "type": "number" },
        "predicted_glucose": { "type": "number" },
        "acknowledged": { "type": "boolean" },
        "acknowledged_at": { "type": "string", "format": "date-time" },
        "created_at": { "type": "string", "format": "date-time" }
      },
      "required": ["alert_timestamp", "alert_id", "device_id", "alert_type", "severity", "alert_message", "acknowledged", "created_at"]
    },
     "user": {
      "title": "User",
      "description": "Generic user for authentication and role management.",
      "type": "object",
      "properties": {
        "uid": { "type": "string" },
        "email": { "type": "string", "format": "email" },
        "displayName": { "type": "string" },
        "role": { "type": "string", "enum": ["doctor", "patient"] }
      },
      "required": ["uid", "email", "role", "displayName"]
    }
  },
  "auth": {
    "providers": ["password", "google.com"]
  },
  "firestore": {
    "/users/{userId}": {
      "schema": { "$ref": "#/entities/user" },
      "description": "Stores basic user auth info and role. All other medical data is stored in GridDB."
    }
  }
}
